<div class="w-full">
  <% if notice.present? %>
    <p class="py-2 px-3 bg-green-50 mb-5 text-green-500 font-medium rounded-lg inline-block" id="notice"><%= notice %></p>
  <% end %>

  <div class="flex justify-between items-center">
    <h1 class="font-bold text-4xl">Points of Interest</h1>
    <%= link_to 'New point of interest', new_point_of_interest_path, class: "rounded-lg py-3 px-5 bg-blue-600 text-white block font-medium" %>
  </div>
  
  <div class="h-80 px-5">
    <div id="map" class="h-80 flex"></div>
  </div>
  
  <script type="text/javascript">
    regMapDiv = "map"
    
    const pointsOfInterest = () => {
      let url = 'http://localhost:3000/point_of_interests.json'
      fetch(url)
       .then((response) => { return response.json(); })
       .then(response => obj = data);
    }

function printToConsole(data) {
  data.map(console.log(x);)
}
    
    var obj;

fetch('https://jsonplaceholder.typicode.com/posts/1')
  .then(res => res.json())
  .then(data => obj = data)
  .then(() => console.log(obj))
console.log(obj);
    
    var map = L.map(regMapDiv).setView([39.76622709413315,-105.22932827525855], 19);
    L.tileLayer(
      'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          maxZoom: 22,
      }).addTo(map);

    
        
    var MobilityIcon = L.Icon.extend({
      options: {
        shadowUrl: '',
        iconSize:     [60, 60],
        shadowSize:   [10,10],
        }
      });
    // var wheelchairConfused = new MobilityIcon({iconUrl: 'wheelchair-confused-red.png'});
    // var bikerWalkerAccident = new MobilityIcon({iconUrl: 'biker-walker-accident-red.png'});
    // var driverWalkerAccident = new MobilityIcon({iconUrl: 'driver-walker-accident-red.png'});
    // var walkerAccident = new MobilityIcon({iconUrl: 'walker-accident-red.png'});
    var driverBikerAccident = new MobilityIcon({iconUrl: "<%= image_url('biker-walker-accident-red.png') %>"  });
    var crossroad = new MobilityIcon({iconUrl: "<%= image_url('crossroad.png') %>"  });
    
    // car-bike conflict areas
  
     // diagnostic/placement helpers
    var popup = L.popup();
    function onMapClick(e) {
      popup
          .setLatLng(e.latlng)
          .setContent("You clicked the map at " + e.latlng.toString())
          .openOn(map);
      console.log("You clicked the map at " + e.latlng);
    }

    map.on('click', onMapClick);
  
  </script>

  <div id="point_of_interests" class="min-w-full">
    <%= render @point_of_interests %>
  </div>
</div>
